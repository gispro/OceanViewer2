<% extends ./base.html %>
<% subskin extrahead %>
    <!-- OpenLayers resources -->
    <link rel="stylesheet" type="text/css" href="externals/openlayers/theme/default/style.css">
    <script type="text/javascript" src="script/OpenLayers.js"></script>

    <!-- GeoExt resources -->
    <link rel="stylesheet" type="text/css" href="externals/GeoExt/resources/css/popup.css">
    <link rel="stylesheet" type="text/css" href="externals/GeoExt/resources/css/layerlegend.css">
    <link rel="stylesheet" type="text/css" href="externals/GeoExt/resources/css/gxtheme-gray.css">
    <script type="text/javascript" src="script/GeoExt.js"></script> 

    <!-- gxp resources -->
    <link rel="stylesheet" type="text/css" href="externals/gxp/src/theme/all.css">
    <script type="text/javascript" src="script/gxp.js"></script> 

    <!-- proj4js resources -->
    <!--<script type="text/javascript" src="externals/proj4js/lib/proj4js-compressed.js"></script>-->

    <!-- GeoExplorer resources -->
    <link rel="stylesheet" type="text/css" href="theme/app/geoexplorer.css" />
    <!--[if IE]><link rel="stylesheet" type="text/css" href="theme/app/ie.css"/><![endif]-->        
    <link rel="stylesheet" type="text/css" href="theme/ux/colorpicker/color-picker.ux.css" />
    <script type="text/javascript" src="script/GeoExplorer.js"></script>
    <script type="text/javascript" src="script/ux.js"></script>
    
    <script>
        Ext.BLANK_IMAGE_URL = "theme/app/img/blank.gif";
        OpenLayers.ImgPath = "theme/app/img/";
		if (GeoExt.Lang) {
			GeoExt.Lang.set("ru");
        }
        var app = new GeoExplorer.Viewer({
            proxy: "proxy/?url=",
            printService: "/geoserver/pdf/",
            about: {
                title: "",
                contact: ""
            },
            defaultSourceType: "gxp_wmscsource",
            sources: {
                suite: {
                    url: "http://v2.suite.opengeo.org/geoserver/ows"
                }
            },
            map: {
                layers: [{
                    name: "World",
                    title: "World",
                    source: "suite",
                    group: "background"
                }],
                center: [0, 0],
                zoom: 2
            }
        });
        
        app.on("ready", function(){
            
            /*var dddddd = {
                    xtype: "grid",
                    ref: "featureGrid",
                    title: "Feature Table",
                    region: "south",
                    height: 150,
                    sm: new GeoExt.grid.FeatureSelectionModel(),
                    store: new GeoExt.data.FeatureStore({
                        fields: [
                            {name: "owner", type: "string"},
                            {name: "agency", type: "string"},
                            {name: "name", type: "string"},
                            {name: "usage", type: "string"},
                            {name: "parktype", type: "string"},
                            {name: "number_fac", type: "int"},
                            {name: "area", type: "float"},
                            {name: "len", type: "float"}
                        ],
                        proxy: new GeoExt.data.ProtocolProxy({
                            protocol: new OpenLayers.Protocol.WFS({
                                url: "http://gisbox.ru:8080/geoserver/ows",
                                version: "1.1.0",
                                featureType: "tries",
                                featureNS: "http://gispro.ru/try",
                                srsName: "EPSG:4326"
                            })
                        }),
                        autoLoad: true
                    }),
                    columns: [
                        {header: "owner", dataIndex: "owner"},
                        {header: "agency", dataIndex: "agency"},
                        {header: "name", dataIndex: "name"},
                        {header: "usage", dataIndex: "usage"},
                        {header: "parktype", dataIndex: "parktype"},
                        {xtype: "numbercolumn", header: "number_fac", dataIndex: "number_fac"},
                        {xtype: "numbercolumn", header: "area", dataIndex: "area"},
                        {xtype: "numbercolumn", header: "len", dataIndex: "len"}
                    ],
                    bbar: []
                };*/
            
           //servicesLoader.load();
           
           app.mapPanel.map.layers[0].mergeNewParams(); 
           for(var ii = 1; ii < app.mapPanel.map.layers.length; ii++){
               app.mapPanel.map.layers[ii].maxExtent = app.mapPanel.map.layers[0].maxExtent;
               if(app.mapPanel.map.layers[ii].mergeNewParams){
                   app.mapPanel.map.layers[ii].mergeNewParams();
               }; 
           }
        });
    </script>
    
